# QuecPython呼叫等待功能使用说明手册

## 功能说明

呼叫等待是一种电话功能，允许用户在通话过程中接听第三方呼叫。当您正在通话时，如果有第三方呼叫进来，您将收到一个提示通知，可以选择接听第二个呼叫或忽略它。这使您能够在通话期间接收其他重要的电话。请注意，呼叫等待功能的可用性可能因运营商和电话设备而异。

呼叫等待功能的前提条件：

1. 运营商支持且开通呼叫等待功能；

   联通默认开通呼叫等待功能；移动默认不开通，需要找运营商开通。

   运营商开通了呼叫等待，在接收到第三方呼叫时，模组能够收到相关呼叫的相关信令，否则第三方呼叫在运营商那边就被拦截了，模组端无任何反应。

2. 模组端开通呼叫等待功能；

   如果运营商开通呼叫等待功能，模组未开通，模组能够收到第三方拨打电话的相关信令，但不会触发第三方来电的回调函数。

呼叫等待功能的开启现象：

​		在呼叫等待开启后，当收到第三方来电或挂断时均会触发回调函数。

## API说明

呼叫等待功能的API是基于voiceCall模块，voiceCall模块（电话功能）的其它API请参考[QuecPython官网Wiki](https://python.quectel.com/doc/API_reference/zh/iotlib/voiceCall.html)说明。

本文只介绍呼叫等待相关API，呼叫等待功能包含在`voiceCall`包中，下面使用整体使用示例，:

```Python
>>> import voiceCall
>>> def cb_fun(args):
...     print('args:',args)
...      
>>> 
>>> voiceCall.setCallback(cb_fun)  # 注册回调函数
0
>>> voiceCall.setCallWait(1)  # 打开呼叫等待功能
0

### 示例 一 ###  均已注册好回调函数和打开呼叫等待功能
>>> voiceCall.callStart("10010")   # 测试使用联通sim卡，拨打联通运营商电话 '10010'
0
>>>
(14, 1, 0, 2, 0, 0, '10010', 129, 0)  # 回调通知当前正在呼出中，触发通话状态回调，

(11, 1, 0, 0, 0, 0, '10010', 129, 0)  # 接通电话，回调通知电话接通事件，触发通话状态回调
# 当前正在和'10010'通话中

>>> 
(10, 2, 1, 5, 0, 0, 'xxxxxxxxxxx', 129, 0)   # 第三方电话呼入，触发回调，此来电进入呼叫等待状态

>>> voiceCall.callHold(2)  # 使当前通话变成保持状态，接通第三方来电
0
>>> 
(11, 2, 1, 0, 0, 0, 'xxxxxxxxxxx', 129, 0)  # 接通第三方来电，回调通知电话接通事件
# 当前正在和'xxxxxxxxxxx'通话中，'10010'进入保持状态的通话

>>> voiceCall.callHold(2)  # 使当前通话变成保持状态，接通进入保持状态的通话(接通'10010')
0
>>> 
(11, 1, 0, 0, 0, 0, '10010', 129, 0)  # 接通进入保持状态的通话，回调通知电话接通事件
# 当前正在和'10010'通话中，'xxxxxxxxxxx'进入保持状态的通话

>>> voiceCall.callHold(0)  # 挂断保持状态的通话
0
>>> 
(12, 2, 1, 6, 0, 0, 'xxxxxxxxxxx', 129, 0)   # 接通保持状态的通话，触发挂断电话的回调函数

>>> voiceCall.callEnd()  # 挂断电话
>>> 
(12, 1, 0, 6, 0, 0, '10010', 129, 0)    # 通话挂断后，触发回调


### 示例 二 ### 均已注册好回调函数和打开呼叫等待功能
>>> voiceCall.callStart("10010")   # 测试使用联通sim卡，拨打联通运营商电话 '10010'
0
>>>
(14, 1, 0, 2, 0, 0, '10010', 129, 0)  # 回调通知当前正在呼出中，触发通话状态回调，

(11, 1, 0, 0, 0, 0, '10010', 129, 0)  # 接通电话，回调通知电话接通事件，触发通话状态回调
# 当前正在和'10010'通话中

>>> 
(10, 2, 1, 5, 0, 0, 'xxxxxxxxxxx', 129, 0)   # 第三方电话呼入，触发回调，此来电进入呼叫等待状态

>>> voiceCall.callHold(0)  # 挂断第三方来电
0
>>> 
(12, 2, 1, 6, 0, 0, 'xxxxxxxxxxx', 129, 0)   # 挂断第三方来电，触发挂断电话的回调函数

>>> 
(10, 2, 1, 5, 0, 0, 'yyyyyyyyyyy', 129, 0)   # 第三方电话呼入，触发回调，此来电进入呼叫等待状态

>>> voiceCall.callHold(1)  # 挂断当前电话，接通第三方来电
0
>>> 
(12, 1, 0, 6, 0, 0, '10010', 129, 0)    # 挂断当前通话，触发挂断电话的回调函数

(11, 2, 1, 0, 0, 0, 'yyyyyyyyyyy', 129, 0)   # 接通第三方来电，回调通知电话接通事件
# 当前正在和'yyyyyyyyyyy'通话中

>>> 
(12, 1, 0, 6, 0, 0, 'yyyyyyyyyyy', 129, 0)    # 对端通话挂断后，触发回调
```



### 开启与关闭呼叫等待

#### `voiceCall.setCallWait`

```python
voiceCall.setCallWait(switch)
```

该方法用于开启或关闭呼叫等待功能，当关闭呼叫等待时，无法触发第三方来电的回调。

**参数描述：**

* `switch` -开启或者关闭呼叫等待功能，整型值，`0`：关闭 , `1`：打开。。

**返回值描述：**

  设置成功返回整型值`0`，设置失败返回整型值`-1`。



>当运营商没有开通呼叫等待功能时，即使模组端开通，模组也收不到第三方呼叫的回调函数。



**示例：**

```python
>>> import voiceCall
>>> voiceCall.setCallWait(1)  # 打开呼叫等待功能
0
```



### 呼叫等待控制

#### `voiceCall.callHold`

```python
voiceCall.callHold(callManOp)
```

该方法用于控制呼叫等待相关业务，当第三方来电时，挂断第三方来电、挂断当前通话接通第三方来电、接通第三方来电使当前通话变成保持状态。

**参数描述：**

* `callManOp` - 呼叫等待控制参数，整型值，具体如下说明：

| 值   | 参数说明                                                     |
| ---- | ------------------------------------------------------------ |
| 0    | 挂断第三方来电或处于保持状态的通话；                         |
| 1    | 接通第三方来电或处于保持状态的通话，挂断当前通话；           |
| 2    | 接通第三方来电或处于保持状态的通话，使当前通话变成保持状态。 |

**返回值描述：**

  成功返回整型值`0`，失败返回整型值`-1`。



> 此接口只能在通话过程中使用。



**示例：**

```python
>>> voiceCall.callHold(0)  # 挂断第三方来电
0

>>> voiceCall.callHold(1)  # 挂断当前电话，接通第三方来电
0
```

